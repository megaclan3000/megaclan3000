


<style type="text/css" media="screen">
.wrapper {
	display: flex;
	width:100%;
}

.scoretable tr {
	line-height: 10px;
	padding: 5px;
}

.scoretable td {
	line-height: 10px;
	padding: 5px;
}


.wrapped {
	flex-basis: 100%;
}

.scoretable {
  table-layout: fixed ;
  width: 100% ;
}

.scoretablenum{
	width: 30px;
	text-align: center;
}

th span {
  transform-origin: 0 50%;
  transform: rotate(-90deg); 
  white-space: nowrap; 
  display: block;
  left: 50%;
}

#chartcontainer-match-players {
	height: 300px;
}


</style>

<div  id="chartcontainer-match-players"></div>

<script charset="utf-8">
	scoreboardChart = Highcharts.chart('chartcontainer-match-players', {
    chart: {
        type: 'column'
    },
    title:  null,
    xAxis: {
        categories: [ "p1", "p2"],
        crosshair: true
    },
    yAxis: {
        min: 0,
        title: null,
    },
    tooltip: {
        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
        pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            '<td style="padding:0"><b>{point.y:.1f} HP</b></td></tr>',
        footerFormat: '</table>',
        shared: true,
        useHTML: true
    },
    plotOptions: {
        column: {
            pointPadding: 0.1,
            borderWidth: 0
        }
    },
    series: [

	{
        name: 'Kills',
        data: [],
    },
	{
        name: 'Deaths',
        data: [],
    },
	{
        name: 'Assists',
		data: [],
    },
	]
});
</script>




<script charset="utf-8">
	$(document).ready(function(){
	$('.collapsible').collapsible();
  });
</script>
<table id="scoretableClan" class="scoretable highlight blue-grey lighten-5">
	<thead>
		<tr>
			<th style="width:40px;"></th>
			<th style="width:140px;"></th>
			<th style="width:80px;"></th>
			<th class="scoretablenum">K</th>
			<th class="scoretablenum">D</th>
			<th class="scoretablenum">A</th>
			<th class="scoretablenum">+/-</th>
			<th class="scoretablenum">K/D</th>
			<th class="scoretablenum">ADR</th>
			<th class="scoretablenum">HS</th>
			<th class="scoretablenum">FK</th>
			<th class="scoretablenum">FD</th>
			<th class="scoretablenum">K</th>
			<th class="scoretablenum">D</th>
			<th class="scoretablenum">FK</th>
			<th class="scoretablenum">FD</th>
			<th class="scoretablenum">1v5</th>
			<th class="scoretablenum">1v4</th>
			<th class="scoretablenum">1v3</th>
			<th class="scoretablenum">5k</th>
			<th class="scoretablenum">4k</th>
			<th class="scoretablenum">3k</th>
		</tr>
	</thead>
	<tbody>



		{{range $p := .Players.Clan}}
		<tr>
			<td> <img class="tableimage" src="{{ $p.AvatarURL }}" alt=""></img> </td>
			<td>{{$p.Name}}<div class="orange-text">{{ $p.Clantag }}</div></td>
			<td> <img class="tableimage" src="/public/{{ $p.Rank }}" alt=""></img></td>
			<td class="scoretablenum">{{ $p.Kills }}</td>
			<td class="scoretablenum">{{ $p.Deaths }}</td>
			<td class="scoretablenum">{{ $p.Assists }}</td>
			<td class="scoretablenum">{{ $p.Kddiff }}</td>
			<td class="scoretablenum">{{ $p.Kd }}</td>
			<td class="scoretablenum">{{ $p.Adr }}</td>
			<td class="scoretablenum">{{ $p.Hsprecent }}</td>
			<td class="scoretablenum">{{ $p.Firstkills }}</td>
			<td class="scoretablenum">{{ $p.Firstdeaths }}</td>
			<td class="scoretablenum">{{ $p.Tradekills }}</td>
			<td class="scoretablenum">{{ $p.Tradedeaths }}</td>
			<td class="scoretablenum">{{ $p.Tradefirstkills }}</td>
			<td class="scoretablenum">{{ $p.Tradefirstdeaths }}</td>
			<td class="scoretablenum">{{ $p.Roundswonv5 }}</td>
			<td class="scoretablenum">{{ $p.Roundswonv4 }}</td>
			<td class="scoretablenum">{{ $p.Roundswonv3 }}</td>
			<td class="scoretablenum">{{ $p.Rounds5K }}</td>
			<td class="scoretablenum">{{ $p.Rounds4K }}</td>
			<td class="scoretablenum">{{ $p.Rounds3K }}</td>
		</tr>
		{{end}}
	</tbody>
	<th></th>
</table>

<table id="scoretableEnemy" class="scoretable highlight blue-grey lighten-5">
	<thead>
		<tr>
			<th style="width:40px;"></th>
			<th style="width:140px;"></th>
			<th style="width:80px;"></th>
			<th class="scoretablenum">K</th>
			<th class="scoretablenum">D</th>
			<th class="scoretablenum">A</th>
			<th class="scoretablenum">+/-</th>
			<th class="scoretablenum">K/D</th>
			<th class="scoretablenum">ADR</th>
			<th class="scoretablenum">HS</th>
			<th class="scoretablenum">FK</th>
			<th class="scoretablenum">FD</th>
			<th class="scoretablenum">K</th>
			<th class="scoretablenum">D</th>
			<th class="scoretablenum">FK</th>
			<th class="scoretablenum">FD</th>
			<th class="scoretablenum">1v5</th>
			<th class="scoretablenum">1v4</th>
			<th class="scoretablenum">1v3</th>
			<th class="scoretablenum">5k</th>
			<th class="scoretablenum">4k</th>
			<th class="scoretablenum">3k</th>
		</tr>
	</thead>
	<tbody>
	</tbody>
</table>

<script id="matchScoreboardTemplate" type="text/x-jquery-tmpl">
		<tr>
			<td> <img class="tableimage" src="${avatar_url}" alt=""></img> </td>
			<td>${name}<div class="orange-text">${clantag}</div></td>
			<td> <img class="tableimage" src="/public/img/ranks/${rank}.png" alt="{$rank}"></img></td>
			<td class="scoretablenum">${kills}</td>
			<td class="scoretablenum">${deaths}</td>
			<td class="scoretablenum">${assists}</td>
			<td class="scoretablenum">${kddiff}</td>
			<td class="scoretablenum">${kd}</td>
			<td class="scoretablenum">${adr}</td>
			<td class="scoretablenum">${hsprecent}</td>
			<td class="scoretablenum">${firstkills}</td>
			<td class="scoretablenum">${firstdeaths}</td>
			<td class="scoretablenum">${tradekills}</td>
			<td class="scoretablenum">${tradedeaths}</td>
			<td class="scoretablenum">${tradefirstkills}</td>
			<td class="scoretablenum">${tradefirstdeaths}</td>
			<td class="scoretablenum">${roundswonv5}</td>
			<td class="scoretablenum">${roundswonv4}</td>
			<td class="scoretablenum">${roundswonv3}</td>
			<td class="scoretablenum">${rounds5k}</td>
			<td class="scoretablenum">${rounds4k}</td>
			<td class="scoretablenum">${rounds3k}</td>
		</tr>
</script>


<script charset="utf-8">

$(document).ready(function(){

	// TODO use correct id
	var url = "/api/matchinfo/1/scoreboard"
	$.getJSON(url,  function( data) {

		//data.sort((a, b) => b.shots - a.shots)

		var arrPlayers = [];
		var arrKills = [];
		var arrDeaths = [];
		var arrAssists = [];

		for (var row = 0; row < data.clan.length; row++) {
			arrKills.push(data.clan[row].kills);
			arrDeaths.push(data.clan[row].deaths);
			arrAssists.push(data.clan[row].assists);
			arrPlayers.push(data.clan[row].name);
			$( "#matchScoreboardTemplate" ).tmpl(data.clan[row]).appendTo( "#scoretableClan tbody" );
		}


		for (var row = 0; row < data.enemy.length; row++) {
			arrKills.push(data.enemy[row].kills);
			arrDeaths.push(data.enemy[row].deaths);
			arrAssists.push(data.enemy[row].assists);
			arrPlayers.push(data.enemy[row].name);
			$( "#matchScoreboardTemplate" ).tmpl(data.enemy[row]).appendTo( "#scoretableEnemy tbody" );
		}

		scoreboardChart.categories = arrPlayers;

        scoreboardChart.xAxis[0].setCategories(arrPlayers); //setting category
		scoreboardChart.series[0].setData(arrKills);
		scoreboardChart.series[1].setData(arrDeaths);
		scoreboardChart.series[2].setData(arrAssists);

		//https://api.highcharts.com/class-reference/Highcharts.Chart.html#addSeries
		// https://api.highcharts.com/class-reference/Highcharts.Series#setData
	});
});

</script>
