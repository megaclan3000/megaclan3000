

<style type="text/css" media="screen">
.wrapper {
	display: flex;
	width:100%;
}

.wrapped {
	flex-basis: 100%;
}

#chartcontainer-match-rounds {
	height: 300px;
}

</style>

<div  id="chartcontainer-match-rounds"></div>

<script charset="utf-8">
	//TODO use real data
	Highcharts.chart('chartcontainer-match-rounds', {
	chart: {
		type: 'column'
	},
	title:  null,
	xAxis: {
		categories: [
		'Round 1',
		'Round 2',
		'Round 3',
		'Round 4',
		'Round 5',
		'Round 6',
		'Round 7',
		'Round 8',
		'Round 9',
		'Round 10',
		'Round 11',
		'Round 12',
		'Round 13',
		'Round 14',
		'Round 15',
		'Round 16',
		'Round 17',
		'Round 18'
		],
		crosshair: true
	},
	yAxis: {
		min: 0,
		title: null,
	},
	tooltip: {
		headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
		pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
			'<td style="padding:0"><b>{point.y:.1f} HP</b></td></tr>',
		footerFormat: '</table>',
		shared: true,
		useHTML: true
	},
	plotOptions: {
		column: {
			pointPadding: 0.1,
			borderWidth: 0
		}
	},
	series: [{
		name: 'Given',
		data: [49.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]
	}, {
		name: 'Taken',
		data: [42.4, 33.2, 34.5, 39.7, 52.6, 75.5, 57.4, 60.4, 47.6, 39.1, 46.8, 51.1]

	}]
});
</script>


<ul class="collapsible" id="roundscontainer"> </ul>

<script id="matchRoundsTemplate" type="text/x-jquery-tmpl">
	<div id="test"> </div>
		<div class="collapsible-header hoverable ${roundcolor} lighten-5" style="padding:0px;">
			<div style="width:100%;padding:0px" class="container">
				<div class="row valign-wrapper" style="margin:10px">
				  <div class="col s1">
					<img style="width:30px;" src="/public/img/teams/${team_won}.jpg" class="circle" alt="">
					</div>
				  <div class="col s3">
					{{`{{each(prop, val) kills_clan}}`}}
						<div style="padding:2px;" class="right"> <img style="width:35px;height:35px;" src="${val.victim.avatar_url}" alt="${val.killer.name}"> </div>
					{{`{{/each}}`}}
				  </div>
				  <div class="col s1 center-align">
					 {{`{{if ClanWonRound }}`}}
					 <img src="/public/img/win_reason/${win_reason}.png" style="width:20px" class="" alt="">
					 {{`{{/if}}`}}
				  </div>
				  <div class="col s2 center-align">
					  <h6> <span class="orange-text">${score_clan}</span>:<span class="blue-text">${score_enemy}</span > </h6>
				  </div>
				  <div class="col s1 center-align">
					{{`{{if !ClanWonRound }}`}}
					<img src="/public/img/win_reason/${win_reason}.png" style="width:20px" class="" alt="">
					{{`{{/if}}`}}
				  </div>
				  <div class="col s3 kill-avatars-enemy">
					{{`{{each(prop, val) kills_enemy}}`}}
						<div style="padding:2px;" class="left"> <img style="width:35px;height:35px;" src="${val.victim.avatar_url}" alt="${val.killer.name}"> </div>
					{{`{{/each}}`}}
				  </div>
				  <div class="col s1 grey-text">${duration}</div>
				</div>
			</div>
		</div>
		<div class="collapsible-body blue-grey lighten-4">
			<div style="width:100%;" class="container">
				<div class="row">
				  <div class="col s6">
					<table class="centered">
						<tbody>
							{{`{{each(prop, val) kills_clan}}`}}
							<tr>
								<td>${val.killer.name}</td >
								<td>${val.weapon_name}</td>
								<td>${val.victim.name}</td >
							</tr>
							{{`{{/each}}`}}
						</tbody>
					</table>
				  </div>

				  <div class="col s6">
					<table class="centered">
						<tbody>
							{{`{{each(prop, val) kills_enemy}}`}}
							<tr>
								<td>${val.killer.name}</td >
								<td>${val.weapon_name}</td>
								<td>${val.victim.name}</td >
							</tr>
							{{`{{/each}}`}}
						</tbody>
					</table>
				  </div>
				</div>
			</div>
		</div>
</script>

<ul class="collapsible" id="roundscontainer"></ul>

<script charset="utf-8">

	$(document).ready(function(){

		$('.collapsible').collapsible();

		// TODO use correct id
		var url = "/api/matchinfo/1/rounds"
		$.getJSON(url,  function( data) {
			for (var round = 0; round < data.length; round++) {
				var roundline = document.createElement("li");
				$( "#matchRoundsTemplate" ).tmpl(data[round]).appendTo(roundline);
				$("#roundscontainer").append(roundline);
			}
		});
	});

</script>
